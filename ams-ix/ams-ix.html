<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <title>Ansible @ AMS-IX</title>
    <link rel="shortcut icon" href="./favicon.ico" />
    <link rel="stylesheet" href="./dist/reset.css" />
    <link rel="stylesheet" href="./dist/reveal.css" />
    <link rel="stylesheet" href="./dist/theme/black.css" id="theme" />
    <link rel="stylesheet" href="./css/highlight/base16/zenburn.css" />


  </head>
  <body>
    <div class="reveal">
      <div class="slides"><section  data-markdown><script type="text/template">

# Ansible @ AMS-IX
</script></section><section  data-markdown><script type="text/template">
## Adfinis

- .ch: RedHat Premium partner
- .nl: HashiCorp EMEA Focus partner of the year 2023
- .nl: GitLab Services Partner of the year 2023 for EMEA

Open Source knowledge center.
</script></section><section  data-markdown><script type="text/template">
## Who are you/we?
</script></section><section  data-markdown><script type="text/template">
## Overview

- Automate everything
- Ansible for OS variations
- GitLab CI
- Event Drive Ansible
- API for AMS-IX
</script></section><section  data-markdown><script type="text/template">
## Automate everything

Besides "normal" use-cases (playbooks & roles):

- [Document generation](https://github.com/robertdebock/ansible-generator)
- [Retry CI](https://github.com/robertdebock/ci-retry)
- [Set a secret on GitHub](file:///Users/robertdb/Documents/github.com/robertdebock/github-set-secret)
- Scripting
- Orchestration
</script></section><section ><section data-markdown><script type="text/template">
## Ansible for OS variations

Ansible is great at writing to solve OS variations.

For example: `httpd` is different on each OS:

- Package name
- Service name
- User & Group
- Configuration & data directory
- Modules path
- Binary name
</script></section><section data-markdown><script type="text/template">
## The HTTPD package name

`httpd/vars/main.yml`:

```yaml
_httpd_packages:
  default:
    - httpd
  Debian:
    - apache2

httpd_package: "{{ _httpd_packages[ansible_os_family] | \
  default(_httpd_packages['default'] }}"
</script></section><section data-markdown><script type="text/template">
## Install HTTPD

`httpd/tasks/main.yml`:

```yaml
- name: Install HTTPD
  ansible.builtin.package:
    name: "{{ httpd_package }}"
```
</script></section><section data-markdown><script type="text/template">
## Full role

- [httpd](https://github.com/robertdebock/ansible-role-httpd)
</script></section></section><section ><section data-markdown><script type="text/template">
## GitLab CI

Testing, releasing and deploying can be done using GitLab (or GitHub).
</script></section><section data-markdown><script type="text/template">
## GitLab Testing

```yaml
image: "robertdebock/github-action-molecule:6.0.1"

molecule:
  script:
    - molecule test
  rules:
    - if: $CI_COMMIT_REF_NAME == "master"
  parallel:
    matrix:
      - image: "enterpriselinux"
        tag: "latest"
      - image: "debian"
        tag: "latest"
```
</script></section><section data-markdown><script type="text/template">
## GitLab releasing

```yaml
image: "robertdebock/github-action-molecule:6.0.1"

galaxy:
  script:
    - ansible-galaxy role import --api-key ${GALAXY_API_KEY} robertdebock ${CI_PROJECT_NAME}
  rules:
    - if: $CI_COMMIT_TAG != null
```
</script></section><section data-markdown><script type="text/template">
## GitLab deploying

Better using Ansible Automation Platform because:

- RBAC
- More readable output
- Execution environment
- Scheduling
- Queueing

> GitLab, build yourself.
</script></section></section><section  data-markdown><script type="text/template">
## Event Driven Ansible

Event Driven Ansible (EDA) reacts to events, and calls Ansible Automation Controller to run a playbook.

```text
+--- source ---+      +--- EDA ---+      +--- AAC ---+
| - monitoring | <--- | runbooks  | ---> |           |
| - event bus  |      +-----------+      +-----------+
| - ...        |                               |
+--------------+                               V
                                       +--- targets ---+
                                       |               |
                                       +---------------+
```
</script></section><section ><section data-markdown><script type="text/template">
## API for AMS-IX

AAP does offer an [API](https://docs.ansible.com/automation-controller/latest/html/controllerapi/api_ref.html#) to integrate AAP in an orchestrator or workflow.
</script></section><section data-markdown><script type="text/template">
## Assumptions

My feeling is that AMS-IX want to expose network related API details, such as:

- Network lists
- Network details
- IP ranges
- Traffic details

Ansible Automation Platform would be hard to fit this requirement.
</script></section></section><section  data-markdown><script type="text/template">
## Conclusion

1. Ansile: Automate everyting
2. AAP/EDA: Easily run Ansible
3. GitLab: Develop and test
</script></section><section  data-markdown><script type="text/template">
## THANKS!
</script></section></div>
    </div>

    <script src="./dist/reveal.js"></script>

    <script src="./plugin/markdown/markdown.js"></script>
    <script src="./plugin/highlight/highlight.js"></script>
    <script src="./plugin/zoom/zoom.js"></script>
    <script src="./plugin/notes/notes.js"></script>
    <script src="./plugin/math/math.js"></script>
    <script>
      function extend() {
        var target = {};
        for (var i = 0; i < arguments.length; i++) {
          var source = arguments[i];
          for (var key in source) {
            if (source.hasOwnProperty(key)) {
              target[key] = source[key];
            }
          }
        }
        return target;
      }

      // default options to init reveal.js
      var defaultOptions = {
        controls: true,
        progress: true,
        history: true,
        center: true,
        transition: 'default', // none/fade/slide/convex/concave/zoom
        plugins: [
          RevealMarkdown,
          RevealHighlight,
          RevealZoom,
          RevealNotes,
          RevealMath
        ]
      };

      // options from URL query string
      var queryOptions = Reveal().getQueryHash() || {};

      var options = extend(defaultOptions, {}, queryOptions);
    </script>


    <script>
      Reveal.initialize(options);
    </script>
  </body>
</html>
