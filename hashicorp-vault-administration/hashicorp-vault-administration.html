<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <title>Vault administration</title>
    <link rel="shortcut icon" href="./favicon.ico" />
    <link rel="stylesheet" href="./dist/reset.css" />
    <link rel="stylesheet" href="./dist/reveal.css" />
    <link rel="stylesheet" href="./dist/theme/black.css" id="theme" />
    <link rel="stylesheet" href="./css/highlight/base16/zenburn.css" />

  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section data-markdown data-separator="\r?\n---\r?\n" data-separator-vertical="\r?\n----\r?\n">
          <textarea data-template>
            

# Vault Administration

---

A guide that goes deeper into configuring HashiCorp Vault.

---

## Introduction

- Who am I?
- Who/what is Adfinis?
- Who are you?

---

## Topics

- Tokens
  - Token types
  - Token leases
- Logs
  - Audit
  - Operational
- Policies
  - Templating
- Configuration
  - CLI
  - Terraform

---

## Vault

A tool to manage *secrets*, typically for *systems*.

> Secrets: Anything sensitive; credentials, API keys, SSL keys, etc.

> Systems: An application like Tomcat, CI, k8s, etc.

----

## Tokens

Tokens are the core method for **authentication** of clients within Vault.

> Nearly all requests to Vault must be accompanied by a token.

Tokens are authenticated by an **auth method**.

---

## Token types - Service and Batch

Two main types of Vault tokens: 

| Token type | Example     |  Description |
|:-----------|:-----------:|:------------:|
| Service    | hv**s**.xxx |              |
| Batch      | hv**b**.xxx |              |

---

## Token types - Recovery Token



---

## Token types - Service Tokens

Vault persists the service tokens in its storage backend.

You can renew a service token or revoke it as necessary.

---

## Token types - Vault CLI

```yaml
Usage: vault token <subcommand> [options] [args]

  This command groups subcommands for interacting with tokens. Users can
  create, lookup, renew, and revoke tokens.

  Create a new token:

      $ vault token create

  Revoke a token:

      $ vault token revoke 96ddf4bc-d217-f3ba-f9bd-017055595017

  Renew a token:

      $ vault token renew 96ddf4bc-d217-f3ba-f9bd-017055595017
```

---

## Token types - batch tokens

Vault does not persist the batch tokens.

They carry minimal information to perform Vault actions, making them lightweight and scalable.

But they lack flexibility and features of service tokens.

---

## Token leases - service token

Leases created by service tokens (including child tokens' leases) are tracked along with the service token and revoked when the token expires.

---

## Token leases - batch token

---

## Logs

- Audit logs
- Operational logs

----

## Policies

Tokens are mapped to *policies*.

Policies describe *permissions* of a Vault token.

----

## Policies templating


----

## Terraform configuration


----

## Auth engines


---

## Secret engines (static)


---

## Secret engines (dynamic)


---

## Questions

---

## Thanks

          </textarea>
        </section>
      </div>
    </div>

    <script src="./dist/reveal.js"></script>

    <script src="./mermaid/dist/mermaid.min.js"></script>

    <script src="./plugin/markdown/markdown.js"></script>
    <script src="./plugin/highlight/highlight.js"></script>
    <script src="./plugin/zoom/zoom.js"></script>
    <script src="./plugin/notes/notes.js"></script>
    <script src="./plugin/math/math.js"></script>
    <script>
      function extend() {
        var target = {};
        for (var i = 0; i < arguments.length; i++) {
          var source = arguments[i];
          for (var key in source) {
            if (source.hasOwnProperty(key)) {
              target[key] = source[key];
            }
          }
        }
        return target;
      }

      // default options to init reveal.js
      var defaultOptions = {
        controls: true,
        progress: true,
        history: true,
        center: true,
        transition: 'default', // none/fade/slide/convex/concave/zoom
        slideNumber: true,
        highlight: {
          highlightOnLoad: false
        },
        plugins: [
          RevealMarkdown,
          RevealHighlight,
          RevealZoom,
          RevealNotes,
          RevealMath
        ]
      };

      // options from URL query string
      var queryOptions = Reveal().getQueryHash() || {};

      var options = extend(defaultOptions, {"width":1400,"height":700,"_":["hashicorp-vault-administration.md"],"static":"output/hashicorp-vault-administration"}, queryOptions);
    </script>


    <script>
      Reveal.initialize(options);
      Reveal.addEventListener('ready', function (event) {
        const blocks = Reveal.getRevealElement().querySelectorAll('pre code:not(.mermaid)');
        const hlp = Reveal.getPlugin('highlight');
        blocks.forEach(hlp.highlightBlock);
      });
    </script>

    <script>
      const mermaidOptions = extend({ startOnLoad: false }, {});
      mermaid.startOnLoad = false;
      mermaid.initialize(mermaidOptions);
      const cb = function (event) { mermaid.init(mermaidOptions, '.stack.present>.present pre code.mermaid'); };
      Reveal.addEventListener('ready', cb);
      Reveal.addEventListener('slidetransitionend', cb);
    </script>
  </body>
</html>
